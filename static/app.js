const form=document.getElementById('form');const progress=document.getElementById('progress');const bar=progress.querySelector('.bar');const result=document.getElementById('result');const toggle=document.getElementById('toggle');toggle.addEventListener('click',()=>document.body.classList.toggle('dark'));form.addEventListener('submit',async(e)=>{e.preventDefault();result.style.display='none';progress.style.display='block';bar.style.width='10%';const fd=new FormData(form);try{bar.style.width='30%';const res=await fetch('/verify',{method:'POST',body:fd});bar.style.width='70%';const data=await res.json();bar.style.width='100%';showResult(data)}catch(err){showResult({error:'Failed to connect to server'})}finally{setTimeout(()=>{progress.style.display='none';bar.style.width='0'},800)} });function showResult(d){result.style.display='block';if(d.error){result.className='result no';result.innerHTML='<div>❌ '+(d.error||'Error')+'</div>'+(d.details?('<pre>'+JSON.stringify(d.details)+'</pre>'): '');return}let cls='no';if(d.match===true)cls='ok';else if(d.match==='review')cls='review';result.className='result '+cls;let html='<div style="font-weight:700;font-size:18px">'+(d.match===true?'✅ Signature Match': d.match==='review'? '⚠️ Review Required':'❌ Signature Mismatch')+'</div>';html+='<div style="margin-top:8px">Confidence: <strong>'+(d.similarity||d.confidence)+'%</strong></div>';if(d.extracted_url)html+='<img src="'+d.extracted_url+'" style="max-width:320px;margin-top:12px;border-radius:6px;border:1px solid rgba(0,0,0,0.06)"/>';if(d.timestamp)html+='<div style="margin-top:8px;font-size:12px;color:var(--muted)">Checked at: '+d.timestamp+'</div>';result.innerHTML=html}